language: php
php:
- '7.0'
env:
  global:
  - COMMIT=${TRAVIS_COMMIT::8}
  - secure: NCwhzKQSy2NZXB6D5kVcYgQQYhz17xoPhH6v2nm+tDLa2LNUtQblZMZMuQcYpy1MmlEfI4J6LRjx5G/0cAav3XldpPRLFfyNSh3R7MD6/YZtQJb2uxUtqM9DBhFqh/44A3NFXaWwWC2vdaXHDoabX2LGV2sUARd6ke5GSudzNqHeY2h+hU6EvbpfKqkM5kHXaXnCHvua+JcHGrxtgcPL/WLsjccgpfpZIDM7cb6CCmmYNoVGcQ7nBap4bxtx5IT/av7HlExcM8RGNPFhSv8AOW3O/K6XjSabzddQdI57M19NQKEnXE3p4aXvjMGPMr0UmQOoGsnhr9fnEF0fklAl8Lvwd1oeM5QhcWW6st0BfnMFTk8IenXFKYxderc7WS1iUx1OWxxDi5p9RGiRIVTOimL5Jk6PFOvtgYIRnQIgX6OkbkR2dphGMAGzc7kCuOC1LWcMe53pVil1FE7BMYIhxlmVKeYbFUB6pdDbKkO0qnKjuicqLgANfZQX3qSC1uznXJ7oyO2iezQjQ9BNgiw/uM9NbA2IcLd3ySD1TnEQw0//DP8kyXOTp6YC/T65OpdlQVQKIufR8gcFUDGd2tbcdTots6Auma3UMZhs2uyJG4uRSz8GCrUtI9uG4oaYYOb6Sms3KMPpTQRoLQHHNrhfsyB5ZlYyUDR/LsX8gU9umi8=
  - secure: lIwBP17J83B3bsYPbMoNf24ZhvnGetChkwczldVfY13G34oFK7o5TrsMDbtE2KY05CR05otUrzPiqVHznS+KA4mG3/L8fPTNGFFqoEJnceT5yB2oZ3gJoiACKS72ADP/dvRWJE0ja9zpuExlwvM7vH/SpwmFBI9vWm58zUxQjdAPojDb336ivQLpJxYk5S+HK6KH7nT5D2xy0+gX3Q7xopU+FgRffywyCV0hCbYvE9s1mpA8XIfql4zChzVNmk0d059Bw385Oq3d3wleZGkFUBXbamIrp3PKB7ieYE+UwKcNNcFQmimQDV1C2y2qQXC4XC6rUxjBV6leUvIQ5nJ8/e7TC/PXDdDe6/AQg5sRnJVA6GUUyXBUzTv691Viu0MbQu+EMyjkoV5kJ+d5GG6umrYh+p6zMfGoOLS8pHjdJl7+VksbOcSR+oL8Da9ZJChoNzkl+gdUP82dp3ArAzRvSutbcibV2s2Cka1Fimi12MK8oVmsfVwLCo9Wod3jan3mi/xWQ75YlgzOaDn5vqqkXWVFhOsByd9+1iiXb3HPYR10U44V1/Vk/BYWmrX0JrYSdZAijpyknV7c3zpclDoBBEEMwvlG5xB6/78nP9f8Q2oxTD8N2faG72c4mgdSxZ6nruzyDxa4gXt1Mn9tKQybOMeouaxwRg330EnzTlDKi4k=
  - secure: qHe6xLiDcgGlnR5SHVBNbaFtw3pIsSJv9syvuTZm9DNHRy6cI2SnWvi0M1atSAsdhELa2hBx9DYinz+2PiCtt52+ZiPS3rDLHtmnam2/u9BKXoreap+PWyfayjWnuw5OiwLntOAZegsqvpvpMZvUUtxdRsXX5gkfne/ZShz9N/z+AKpeAtwc+jbMt7PFHdG5+MyzgXinaLBmmOYZKN4EKLLSClzMBNAk3vdEryXslSFaS6rF37Jlo8mP6xm/zn8sl2t/zOrasEccw4Vm9S/C7NPOS+sr1Bl+C9Oi/cgXe+8RqdsWZO6+NMv6v2VuraYIi7e++L9WAiNreYJu97r+Pp7vdD/NIqOMscaNZIRSAZ1FxPHqxLELBbBkAf+XIO7XtBpnLq7NbuA8o5OdvymSCmKG5oSjqGqzmSj9iFG63U5LDb7i+avLlGzDnPAtmRjWVJRpHKw10+Gq/btC8x0LKhZReI9gwtIRDP4RYDKr42AlypsH9ddyc1oVT/NSzP6/vp+Lf0BGlOYYl4LKGWukrd0Y/UlCjAC1X+/Vk6X+eBSea5U/6kvvbK2J4D3dMaAEOU/91yEWlQCfiXav01kcapCPhrp1h1fc2jU+HTh+PZeD5jdnn6NJT+8nUwVsSV2JIeK7qeMUWVqi8/KoFgWsuMiFGz+zo7MH6PEh4nt6iZ8=
script:
- ls -alh
- docker login -u $DOCKER_USER -p $DOCKER_PASS
- export REPO=netsyos/openvpn
- export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo $TRAVIS_BRANCH;
  fi`
- docker build -f Dockerfile -t $REPO:$COMMIT .
- docker tag $REPO:$COMMIT $REPO:$TAG
- docker tag $REPO:$COMMIT $REPO:travis-$TRAVIS_BUILD_NUMBER
- docker push $REPO
after_success:
- date
notifications:
  slack:
    secure: WH5Nvqe2l6gLpTZk8Qp1DQ9iW07QNM1PBRMuShs70t+EM2tLLs8qCvqlF8qyK9Gt6PQTPqFbtlE/fTx6CH04U8T94TNRf0IYoEOLOKTps9uL27s5wq6E+XEyk/Uh0iP0Ajs+K/FmOFS0lrwzJAJawvv5Dn11bgQCy0p/6r1oVo+8DKLnFB5kJuNWeCXyDkwx5go/k+Da4GSWWid7vBVyN9/BV8sZTdO1vgSFIOXuC7fKu7U737l7W69K9dnjuWg/H0pitE0I5suErepsT5GHMymeMWbnuOz5mPho54A0MzLmfA1usO8+XfuE7ABJuvRk2vy+BWx0aI7YxrTmk3QGUV8db8CiANg/jjqSFwumDzViq/TOUoog1JU94iYNH+7HyQbE9gp8wWrobGqn0Ai/4SdHaC/epoP4ZsbA+56/9sqC9CYMQc0pn/vuDVyYq24GJlko0HP0omPjV8zvP7lf75zn+KSUmDuKAA0ibtJ6ncLtcM+31dFDzul966fuBFIqsez9XztK3b0xlXEAT4dTa6jskU/wdwh0n8oEZWmskrEK2qB+c5vTpbGQECSR+G9Kpcnp/s+kTj5PMxLtRMLP07mjG6sFC0K9zRa3XeKfztUzxmxSuLIdaDQF4/2kVdHLE+KRIzqLQQh/tWqVxqEcyJ22RPUgJMOnNl1uBCUvT+0=
